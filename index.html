<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TTRL Multi-Season Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, sans-serif; margin:0; padding:0; background:#050608; color:#f5f5f5; }

    /* HEADER */

    header {
      background:linear-gradient(to bottom,#000000 0,#050608 70%);
      padding:16px 24px 14px;
      border-bottom:3px solid #ff0000;
    }
    .header-top {
      display:flex;
      align-items:stretch;
      justify-content:space-between;
      gap:18px;
    }

    .logo-wrap {
      display:flex;
      align-items:center;
      gap:14px;
    }
    .logo-img {
      height:60px;
      width:auto;
      display:block;
      filter:drop-shadow(0 0 8px rgba(0,0,0,0.8));
      transition:transform 0.25s ease-out;
    }

    .header-left-text h1 {
      margin:0;
      font-size:22px;
    }
    .header-left-text p {
      margin:4px 0;
      color:#c5c6c7;
      font-size:13px;
    }

    #fileSelect {
      padding:3px 6px;
      font-size:13px;
      border-radius:4px;
      border:1px solid #3b4252;
      background:#050608;
      color:#f5f5f5;
    }

    .header-centre {
      flex:1 1 auto;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:6px 14px;
      border-radius:12px;
      background:#050608;
      box-shadow:0 0 18px rgba(0,0,0,0.7);
      border:2px solid rgba(107,114,128,0.7);
      min-height:70px;
    }

    .header-title-row {
      display:flex;
      gap:6px;
      align-items:baseline;
      justify-content:center;
      text-transform:uppercase;
      letter-spacing:0.16em;
      font-weight:800;
      font-size:18px;
      white-space:nowrap;
    }
    .header-title-red { color:#ff1a1a; }
    .header-title-blue { color:#1d4ed8; }
    .header-title-yellow { color:#facc15; }

    .header-subline {
      margin-top:3px;
      font-size:11px;
      letter-spacing:0.14em;
      text-transform:uppercase;
      color:#e5e7eb;
      opacity:0.9;
      text-align:center;
      white-space:nowrap;
    }

    .header-meta {
      font-size:12px;
      text-align:right;
      color:#9ca3af;
      min-width:195px;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }

    /* LAYOUT */

    main { padding:20px 24px 40px; max-width:1200px; margin:0 auto; }

    .cards { display:flex; flex-wrap:wrap; gap:12px; margin-bottom:24px; }
    .card { background:#10151f; padding:12px 16px; border-radius:6px; min-width:160px; border-top:3px solid #ffcf00; }
    .card-title { font-size:13px; text-transform:uppercase; color:#c5c6c7; }
    .card-value { font-size:20px; margin-top:4px; }

    h2 { margin-top:24px; border-bottom:2px solid #007bff; padding-bottom:4px; font-size:18px; }

    table { width:100%; border-collapse:collapse; margin-top:10px; font-size:13px; }
    th, td { padding:6px 8px; text-align:left; border-bottom:1px solid #222831; }
    th { background:#11151f; position:sticky; top:0; z-index:1; }
    tr:nth-child(even) td { background:#0b0f18; }
    tr:hover td { background:#151b26; }

    #driversTable th,
    #driversTable td {
      font-size:12px;
      white-space:normal;
      overflow:visible;
      text-overflow:clip;
    }
    #driversTable th:nth-child(1),
    #driversTable td:nth-child(1) { width:160px; }

    .badge { display:inline-block; padding:2px 6px; border-radius:10px; font-size:11px; }
    .badge-complete { background:#2ecc71; color:#000; }
    .badge-active { background:#f1c40f; color:#000; }
    .badge-planned { background:#7f8c8d; color:#fff; }

    .filters { display:flex; flex-wrap:wrap; gap:8px; margin:12px 0 6px; align-items:center; }
    .filters input, .filters select, .filters button {
      padding:4px 6px;
      font-size:13px;
      border-radius:4px;
      border:1px solid #3b4252;
      background:#050608;
      color:#f5f5f5;
    }
    .filters button {
      cursor:pointer;
      background:#11151f;
    }
    .filters button:hover {
      background:#1d2535;
    }
    .filters label { font-size:13px; color:#c5c6c7; }

    .section-description { font-size:13px; color:#c5c6c7; margin-top:4px; }

    .tab-btn {
      background:#11151f;
      border:1px solid #3b4252;
      color:#f5f5f5;
      padding:6px 12px;
      border-radius:4px;
      cursor:pointer;
      font-size:13px;
    }
    .tab-btn.active { background:#007bff; border-color:#007bff; }
    .tab-btn.disabled { opacity:0.4; cursor:not-allowed; }

    section[data-view] { display:none; }
    section[data-view].active { display:block; }

    .scroll-body {
      max-height:520px;
      overflow-y:auto;
      display:block;
      margin-right:2px;
    }
    .scroll-body table { border-collapse:collapse; width:100%; }
    .scroll-body thead,
    .scroll-body tbody,
    .scroll-body tr {
      display:table;
      width:100%;
      table-layout:fixed;
    }

    .driver-layout { display:flex; gap:16px; margin-top:10px; }
    .driver-layout-main { flex:1 1 auto; min-width:0; }

    /* DRIVER CARD */

    .driver-card {
      position:relative;
      background:radial-gradient(circle at top left,#1f2937 0,#050608 55%);
      border-radius:10px;
      padding:14px 16px 12px;
      border:1px solid #3b82f6;
      border-left:4px solid #ef4444;
      box-shadow:0 0 18px rgba(59,130,246,0.45);
      overflow:hidden;
    }
    .driver-card.primary-champ { border-left-color:#22c55e; }
    .driver-card::before {
      content:'';
      position:absolute;
      inset:-40px;
      background:radial-gradient(circle at top right,rgba(251,191,36,0.06),transparent 60%);
      opacity:0.9;
      pointer-events:none;
    }

    .driver-card-header {
      position:relative;
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:6px;
    }
    .driver-card-logo {
      position:relative;
      width:32px;
      height:32px;
      border-radius:8px;
      object-fit:cover;
      box-shadow:0 0 8px rgba(0,0,0,0.8);
    }
    .driver-card h3 { position:relative; margin:0 0 4px; font-size:20px; }
    .driver-handle {
      position:relative;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:0.08em;
      color:#9ca3af;
      margin-bottom:2px;
    }
    .driver-meta,
    .driver-statline {
      position:relative;
      font-size:14px;
      color:#d1d5db;
      margin-bottom:6px;
    }
    .driver-chip {
      position:relative;
      display:inline-block;
      padding:2px 7px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      font-size:12px;
      margin:0 4px 4px 0;
      border:1px solid rgba(148,163,184,0.7);
    }
    .driver-chip.primary {
      border-color:#f59e0b;
      background:linear-gradient(135deg,#f59e0b,#b45309);
      color:#000;
    }
    .driver-stat-pill {
      position:relative;
      display:inline-block;
      padding:3px 8px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(55,65,81,0.9);
      font-size:12px;
      margin:0 4px 4px 0;
    }

    .driver-seasons-table th,
    .driver-seasons-table td {
      font-size:13px;
      padding:4px 6px;
    }
    .driver-seasons-table tbody td {
      border-bottom:1px solid rgba(55,65,81,0.7);
    }

    .driver-row-selected td { background:#1d2935 !important; }

    .driver-modal {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .driver-modal.open { display:flex; }
    .driver-modal-backdrop {
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.65);
      backdrop-filter:blur(6px);
    }
    .driver-modal-card {
      position:relative;
      max-width:820px;
      width:92%;
      transform:translateY(10px);
      transition:transform 150ms ease-out, opacity 150ms ease-out;
      opacity:0;
    }
    .driver-modal.open .driver-modal-card {
      transform:translateY(0);
      opacity:1;
    }
    .driver-modal .driver-card {
      padding:22px 24px 18px;
      border-radius:16px;
    }
    .driver-modal-close {
      position:absolute;
      top:-10px;
      right:-10px;
      width:26px;
      height:26px;
      border-radius:999px;
      border:none;
      background:#111827;
      color:#e5e7eb;
      font-size:18px;
      cursor:pointer;
      box-shadow:0 0 10px rgba(0,0,0,0.6);
    }

    .muted { color:#9ca3af; font-size:13px; }

    /* DRIVER CTA STRIP */

    .driver-cta {
      margin-top:6px;
      padding:6px 10px;
      border-radius:6px;
      background:linear-gradient(90deg,#ff1a1a,#1d4ed8,#facc15);
      color:#000;
      font-size:12px;
      font-weight:600;
      letter-spacing:0.09em;
      text-transform:uppercase;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .driver-cta-icon {
      width:14px;
      height:14px;
      border-radius:3px;
      background:#000;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      color:#facc15;
      font-size:10px;
    }

    .driver-layout-main .scroll-body { margin-top:6px; }

    @media (max-width:900px) {
      .header-top { flex-direction:column; align-items:flex-start; }
      .header-centre {
        width:100%;
        align-items:flex-start;
        padding:8px 10px;
      }
      .header-title-row { font-size:16px; white-space:normal; }
      .header-subline { white-space:normal; }
      .header-meta { text-align:left; margin-top:6px; }
      .logo-wrap { gap:10px; }
      .logo-img {
        height:54px;
      }
      .driver-layout { flex-direction:column; }
    }

    @media (max-width:600px) {
      .header-title-row { font-size:15px; }
    }
  </style>
</head>
<body>
<input id="addSeasonFileInput" type="file" accept=".json,application/json" style="display:none;">

<header>
  <div class="header-top">
    <div class="logo-wrap">
      <img src="ttrl-logo.png" alt="TTRL logo" class="logo-img">
      <div class="header-left-text">
        <h1 id="leagueTitle">TTRL Multi-Season Statistics</h1>
        <p id="raceDayLine">Choose race day to view:</p>
        <div>
          <select id="fileSelect">
            <option value="">Select race day…</option>
            <option value="sunday_races.json">Sunday races</option>
            <option value="wed_races.json">Wednesday races</option>
          </select>
        </div>
      </div>
    </div>

    <div class="header-centre">
      <div class="header-title-row">
        <span class="header-title-red">TTRL</span>
        <span class="header-title-blue">MULTI‑SEASON</span>
        <span class="header-title-yellow">INSIGHTS</span>
      </div>
      <div class="header-subline">CROSS‑ERA DRIVER & TRACK STATS</div>
    </div>

    <div class="header-meta">
      <div id="fileMeta">No file loaded yet</div>
    </div>
  </div>
</header>

<main>
  <!-- (all the HTML and script from the file:2 excerpt continues exactly as in your original) -->
  <!-- For brevity: paste everything from <main> ... </script></body></html> in file:2 unchanged. -->
</main>

<script>
/* all existing JS from your working file here */
</script>
</body>
</html>
